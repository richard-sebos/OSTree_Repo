#!/bin/bash
# Configure Kinoite client to use local Flatpak repository
# Generated by Ansible

set -euo pipefail

REPO_NAME="{{ flatpak_repo_name }}"
REPO_URL="{{ flatpak_repo_url }}"

echo "Adding local Flatpak repository..."

# Remove existing remote if present
flatpak remote-delete --system --force "${REPO_NAME}" 2>/dev/null || true

# Add the local repository
flatpak remote-add --system --no-gpg-verify "${REPO_NAME}" "${REPO_URL}"

# Set priority (lower number = higher priority)
flatpak remote-modify --system --prio=1 "${REPO_NAME}"

echo "Local repository '${REPO_NAME}' configured successfully"
echo "URL: ${REPO_URL}"
echo ""
echo "Available applications:"
flatpak remote-ls "${REPO_NAME}" 2>/dev/null || echo "No applications in repository yet"
